# TryHackMe - Basic Penetration Testing

I've completed TryHackMe's Basic Penetration Testing room. This is a writeup for myself after completion, a sort of step-by-step walkthrough, for future reference.

## 0. Basic info

We are to gain access to a web application, and use privilege escalation to (ultimately) root ourselves.

I have a keepnote notebook which I will be referencing during this writeup. It contains screenshots of what I've done exactly, this is a more abstract writeup.

## 1. Initial scanning

After pinging the server to see if I've set up everything on TryHackMe correctly, I've first used nmap to scan for open ports:

`nmap -sC -sV -oN ./nmap/initial 10.10.95.56`

nmap [Scan Type(s)] [Options]

This lead me to find the following ports open:
```
22 - SSH
80 - HTTP
139 - SMB
445 - SMB
8009 - ajl13
8080 - HTTP
```

I then checked port 80 by typing the IP in a web browser, but found nothing out of the ordinary. Viewing the page source, however, revealed a message:
`Check our dev note section if you need to know what to work on`

## 2. Hidden directories

The next step was finding hidden directory of the HTTP server. For this, I used dirbuster, with the wordlist found at `/usr/share/dirb/wordlists/common.txt` on my Kali VM.

This lead me to find the development folder, which had two .txt files. From them, I've learned that there are two developers, `K` and `J`, who have access to the site, and that `J` has a weak password.

## 3. Gaining access

### Finding a username
I first used enum4linux to try to find usernames:
`enum4linux -a 10.10.95.56`

This lead me to find the names `kay` and `jan`, presumably `K` and `J` developers respectively.

### Password cracking
Since I knew `jan` had weak credentials, that account was a better target then `kay`.

I used `hydra` with the `unix_passwords.txt` wordlist, to find out that `jan`'s password is `armando`.

## 4. Snooping around

After logging into the server as `jan`, I looked around her files. Nothing of interest was found, however, I noticed that she could view `kay`'s files too, where I found the very enticing looking `pass.bak` file.

From the `.ssh` folder, I've also found the `id_rsa` file, containing an SSH key.

NOTE_TO_SELF: In future attempts, I should use an enumeration script such as LinPEAS for this process, instead of (just) manual snooping.

## 5. Gaining access as kay

Trying to login with the SSH key as `kay` shows us that it is password protected:
`ssh -i kay-id-rsa kay@10.10.64,18`

### Cracking
I used John the Ripper to crack the SSH file. First, we needed to hash the key:
`python /usr/share/john/ssh2john.py kay-id-rsa > kay-id-rsa.hash`

After that, I've cracked the hash using the `rockyou.txt` wordlist:
`/usr/sbin/john --wordlist=/home/kali/Desktop/rockyou.txt/rockyou.txt kay-id-rsa.hash`

This resulted in gaining the password `beeswax`

### Access as kay
Now I could login as `kay` using the above specified command, together with the password `beeswax`:
`ssh -i kay-id-rsa kay@10.10.64,18`

I finally had access to `pass.bak`, which contained `kay`'s password:
`heresareallystrongpasswordthatfollowsthepasswordpolicy$$`

## 6. Escalation to root

After typing in `sudo -l` as `kay`, (and then his really long password), I could see, that `kay` can use all sudo commands.

After this, I just had to use `sudo su` to escalate myself to root, and thus get to the end of the challenge.

## Lessons for myself
* Notekeeping
I should keep notes of every command I type, and every information I gain. Reconstructing this writeup was a lot harder, since I didn't remember every single command I typed

* Learning specific tools
I should write small guides/cheatsheets for myself on specific scripts, to remember why I used them in the way I did

* I really need to get a proper, English QWERTY keyboard to use in place of my laptop's built in Hungarian one, or figure out a way to have the Kali VM read from mine properly

